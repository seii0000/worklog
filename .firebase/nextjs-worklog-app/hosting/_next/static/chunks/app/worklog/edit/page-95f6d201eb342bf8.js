(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{7716:function(e,t,a){Promise.resolve().then(a.bind(a,862))},6612:function(e,t,a){"use strict";var o=a(9268),s=a(6006),r=a(6008),l=a(5825),n=a(8706),u=a(6936);t.Z=e=>{let{initialData:t={},onSubmit:a}=e,{user:i}=(0,l.useAuth)(),d=(0,r.useRouter)(),[c,p]=(0,s.useState)(t.task||""),[h,m]=(0,s.useState)(t.source||""),[x,g]=(0,s.useState)(t.product||""),[f,b]=(0,s.useState)(t.price||""),[w,y]=(0,s.useState)(t.notes||""),[v,j]=(0,s.useState)(t.date||new Date().toISOString().split("T")[0]),[k,N]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t.date&&j(t.date)},[t.date]);let S=async e=>{if(e.preventDefault(),!i){alert("You must be logged in to submit a worklog.");return}N(!0);try{let e={userId:i.uid,task:c,source:h,product:x,price:parseFloat(f),notes:w,date:v,createdAt:u.EK.now()};if(t.id){let a=(0,u.JU)(n.db,"worklogs",t.id);await (0,u.r7)(a,e)}else await (0,u.ET)((0,u.hJ)(n.db,"worklogs"),e);d.push("/profile")}catch(e){console.error("Error submitting worklog:",e),alert("Error submitting worklog")}finally{N(!1)}};return(0,o.jsxs)("form",{onSubmit:S,className:"max-w-lg mx-auto p-4 bg-white shadow-md rounded",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-4",children:t.id?"Edit Worklog":"New Worklog"}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"date",children:"Date"}),(0,o.jsx)("input",{type:"date",id:"date",value:v,onChange:e=>j(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"task",children:"Task"}),(0,o.jsx)("input",{type:"text",id:"task",value:c,onChange:e=>p(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"source",children:"Source"}),(0,o.jsx)("input",{type:"text",id:"source",value:h,onChange:e=>m(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"product",children:"Product"}),(0,o.jsx)("input",{type:"text",id:"product",value:x,onChange:e=>g(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"price",children:"Price"}),(0,o.jsx)("input",{type:"number",id:"price",value:f,onChange:e=>b(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"notes",children:"Notes"}),(0,o.jsx)("textarea",{id:"notes",value:w,onChange:e=>y(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsx)("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ".concat(k?"opacity-50 cursor-not-allowed":""),disabled:k,children:k?"Saving...":t.id?"Update Worklog":"Add Worklog"})}),k&&(0,o.jsx)("div",{className:"flex justify-center mt-4",children:(0,o.jsx)("div",{className:"loader"})})]})}},5825:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthContextProvider:function(){return i},useAuth:function(){return d}});var o=a(9268),s=a(6006),r=a(4734),l=a(8706),n=a(6936);let u=(0,s.createContext)(),i=e=>{let{children:t}=e,[a,i]=(0,s.useState)(null),d=async()=>{let e=new r.hJ;try{let t=await (0,r.rh)(l.I,e),a=t.user;await (0,n.pl)((0,n.JU)(l.db,"employees",a.uid),{name:a.displayName,email:a.email,photoURL:a.photoURL,uid:a.uid}),await (0,n.pl)((0,n.JU)(l.db,"userMap",a.uid),{name:a.displayName}),i(a)}catch(e){console.error("Error signing in with Google:",e)}};return(0,s.useEffect)(()=>{let e=(0,r.Aj)(l.I,e=>{i(e)});return()=>e()},[]),(0,o.jsx)(u.Provider,{value:{user:a,googleSignIn:d,logOut:()=>{(0,r.w7)(l.I)}},children:t})},d=()=>(0,s.useContext)(u)},8706:function(e,t,a){"use strict";a.d(t,{I:function(){return n},db:function(){return u}});var o=a(1313),s=a(4734),r=a(6936);let l=(0,o.ZF)({apiKey:"AIzaSyBvKkpUNy1KqyE2LzZZKic1vu4pody4fGU",authDomain:"nextjs-worklog-app.firebaseapp.com",projectId:"nextjs-worklog-app",storageBucket:"nextjs-worklog-app.firebasestorage.app",messagingSenderId:"50437099751",appId:"1:50437099751:web:4f5c728f2c6756f262d242"}),n=(0,s.v0)(l),u=(0,r.ad)(l)},862:function(e,t,a){"use strict";a.r(t);var o=a(9268),s=a(6006),r=a(6008),l=a(5825),n=a(6936),u=a(8706),i=a(6612);t.default=()=>{let{user:e}=(0,l.useAuth)(),t=(0,r.useRouter)(),a=(0,r.useSearchParams)(),[d,c]=(0,s.useState)(null),[p,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=a.get("log");if(e){let t=JSON.parse(decodeURIComponent(e));c({id:t.id,date:t.date||"",task:t.task||"",source:t.source||"",product:t.product||"",price:t.price||"",notes:t.notes||""})}},[a]);let m=async a=>{if(e&&!p){h(!0);try{let e=(0,n.JU)(u.db,"worklogs",d.id);await (0,n.r7)(e,a),alert("Worklog updated successfully!"),t.push("/profile")}catch(e){console.error("Error updating worklog:",e),alert("Error updating worklog")}finally{h(!1)}}};return d?(0,o.jsxs)("div",{className:"max-w-2xl mx-auto p-4",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Chỉnh sửa nhật k\xfd c\xf4ng việc"}),(0,o.jsx)(i.Z,{initialData:d,onSubmit:m})]}):(0,o.jsx)("p",{children:"Loading..."})}},6008:function(e,t,a){e.exports=a(794)}},function(e){e.O(0,[662,913,661,253,769,744],function(){return e(e.s=7716)}),_N_E=e.O()}]);